#!/bin/bash

source $(dirname "${BASH_SOURCE[0]}")/.abash/abash.sh

indent() {
  echo "$1" | sed 's/^/ /g'
}

prompt_color() {
  [ -f /etc/prompt-color ] && cat /etc/prompt-color
}

print_motd_file() {
  [ -f "$1" ] && echo -e "\n$(indent "$(cat $1)")"
}

print_motd_banner() {
  BANNER_FILE=/etc/motd-banner-console
  ispty && BANNER_FILE=/etc/motd-banner

  echo -en "\e[1;$(prompt_color)m"
  print_motd_file $BANNER_FILE
  echo -en '\e[0m'
}

print_motd_body() {
  print_motd_file /etc/motd
}

print_motd_warning() {
  print_motd_file /etc/motd-warning
}

print_motd_banner
echo -e "\n $(uname -sr) ($(uptime -p))"
print_motd_body
arge warning && print_motd_warning
echo
